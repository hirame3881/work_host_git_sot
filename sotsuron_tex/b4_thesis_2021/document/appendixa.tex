\chapter{データの前処理}

\label{chap:prepro}
提案ネットワークに考えられる課題として、NTM内部で項目の並び順に一貫性が無くなることで、関係メモリの学習を阻害することが予想される。
これは入力との類似度に応じてスロットの忘却・上書きを行う機構や、DNCでは空いた場所から優先的に書き込む機構が関係推論の計算と独立していることによる。
この問題は入力が長期化し、忘却が頻繁に行われる場合により顕著になると考えられる。
メモリ全体を常に一貫性をもって解釈するために、以下の2種類のモジュールを提案する。
全体としてはこれらのモジュールが項目メモリの順序を整理・解釈した後に関係メモリに入力する構造となる。
\\１．DNCの時間リンク行列はスロット間の時間的な前後関係を表すグラフと捉えられる。これを元にメモリ項目にグラフアテンション(GAT)\cite{gat}をかけることで、時間的に局所的な情報(文脈)を考慮した情報へと解釈できる。
\\２．各スロットの書き込み頻度をもとにソートする。
\\End-To-End Memory Networks\cite{E2E}のようにメモリ内でデータが時系列で並ぶモデルやSAM[8]のように項目がメモリ全体に分散するモデルでは学習を通してメモリの解釈は一貫していると考えられるため、順序整理モジュールは新しい取り組みである。｛要サーベイ｝


\section{ヒストリカルデータ}
為